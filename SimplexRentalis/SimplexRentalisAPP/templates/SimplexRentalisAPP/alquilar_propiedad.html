{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>Reservar Propiedad</h2>
    
    <form id="reservaForm" method="post">
        {% csrf_token %}
        
        <!-- Selección de fechas -->
        <div class="form-group">
            <label for="fechaInicio">Fecha de comienzo:</label>
            <input type="date" id="fechaInicio" name="fecha_inicio" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="fechaFin">Fecha de fin:</label>
            <input type="date" id="fechaFin" name="fecha_fin" class="form-control" required>
        </div>

        <!-- Selección de cantidad de personas -->
        <div class="form-group">
            <label for="cantidadPersonas">Cantidad de personas:</label>
            <select id="cantidadPersonas" name="cantidad_personas" class="form-control">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>

        <!-- Formulario de identidad del usuario -->
        <h3>Información del titular de la reserva</h3>
        <div id="identidadTitular">
            <!-- Verifica si existe un formulario de identidad para el usuario -->
            {% if identidad_form %}
                {{ identidad_form.as_p }}
            {% else %}
                <p>No tienes una identidad registrada. Por favor, completa tu información antes de continuar.</p>
            {% endif %}
        </div>

        <!-- Formularios adicionales para acompañantes -->
        <h3>Información de acompañantes</h3>
        <div id="formulariosAcompanantes"></div>

        <!-- Botón para enviar -->
        <button type="submit" class="btn btn-primary">Reservar</button>
    </form>
</div>

<script>
    // JavaScript para generar formularios adicionales
    document.getElementById('cantidadPersonas').addEventListener('change', function() {
        const cantidad = parseInt(this.value, 10);
        const container = document.getElementById('formulariosAcompanantes');
        container.innerHTML = ""; // Limpiar formularios existentes

        // Generar formularios para cada acompañante
        for (let i = 2; i <= cantidad; i++) {
            const formHtml = `
                <div class="form-group">
                    <h4>Acompañante ${i}</h4>
                    
                    <label for="tipoDocumento_${i}">Tipo documento:</label>
                    <input type="text" id="tipoDocumento_${i}" name="acompanante_${i}_tipo_documento" class="form-control" required>
                    
                    <label for="numeroDocumento_${i}">Numero documento:</label>
                    <input type="text" id="numeroDocumento_${i}" name="acompanante_${i}_numero_documento" class="form-control" required>
                    
                    <label for="fechaExpedicion_${i}">Fecha expedicion:</label>
                    <input type="date" id="fechaExpedicion_${i}" name="acompanante_${i}_fecha_expedicion" class="form-control" required>
                    
                    <label for="primerApellido_${i}">Primer apellido:</label>
                    <input type="text" id="primerApellido_${i}" name="acompanante_${i}_primer_apellido" class="form-control" required>
                    
                    <label for="segundoApellido_${i}">Segundo apellido:</label>
                    <input type="text" id="segundoApellido_${i}" name="acompanante_${i}_segundo_apellido" class="form-control">
                    
                    <label for="nombre_${i}">Nombre:</label>
                    <input type="text" id="nombre_${i}" name="acompanante_${i}_nombre" class="form-control" required>
                    
                    <label for="sexo_${i}">Sexo:</label>
                    <select id="sexo_${i}" name="acompanante_${i}_sexo" class="form-control" required>
                        <option value="masculino">Masculino</option>
                        <option value="femenino">Femenino</option>
                        <option value="otro">Otro</option>
                    </select>
                </div>
            `;
            container.innerHTML += formHtml;
        }
    });
</script>
{% endblock %}
